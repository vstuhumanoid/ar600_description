<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

	<!--
		Solid Works conversion
		x <- z
		y <- x
		z <- y
	-->

	<xacro:macro name="leg" params="parent side"> 

		<xacro:left_right side="${side}"/>

		<!-- Links -->
		<link name="hip_fork_${side}">
	 		<xacro:meshes file="hip_fork_${side}" collision="True"/>
	 		<inertial>
	 			<origin xyz="${-0.02 * x_sign} 0 0.07" rpy="0 0 0"/>
      			<mass value="0.907"/>
      			<inertia ixx="0.004196" ixy="${-x_sign * 0.000201}" ixz="${-x_sign * 0.000014}"
      				                    iyy="0.001524"  iyz="-0.000269"
      				                                    izz="0.003769"/>
    		</inertial>
	 	</link>

	 	<link name="hip_cross_${side}">
	 		<xacro:meshes file="hip_cross_${side}"/>
	 		<inertial>
	 			<origin xyz="${-0.03 * x_sign} 0.01 0.00" rpy="0 0 0"/>
      			<mass value="0.754"/>
      			<inertia ixx="0.001265" ixy="0.000000" ixz="0.000000"
      				                    iyy="0.000786" iyz="0.000000"
      				                                   izz="0.001560"/>
    		</inertial>
	 	</link>

	 	<link name="hip_${side}">
	 		<xacro:meshes file="hip_${side}" collision="True"/>
	 		<inertial>
	 			<origin xyz="${0.01 * x_sign} 0.00 -0.14" rpy="0 0 0"/>
      			<mass value="4.04"/>
						<inertia ixx="0.035175" ixy="-0.000067" ixz="0.000877"
      				                    iyy="0.040670" iyz="-0.000379"
      				                                   izz="0.011745"/>
    		</inertial>
	 	</link>

	 	<link name="shin_${side}">
	 		<xacro:meshes file="shin_${side}" collision="True"/>
	 		<inertial>
	 			<origin xyz="0.00 0.01 -0.11" rpy="0 0 0"/>
      			<mass value="2.24"/>
						<inertia ixx="0.011381" ixy="0.000079" ixz="0.000000"
      				                    iyy="0.013862" iyz="-0.000663"
      				                                   izz="0.005662"/>
    		</inertial>
	 	</link>

	 	<link name="ankle_${side}">
	 		<xacro:meshes file="ankle_${side}"/>
	 		<inertial>
	 			<origin xyz="${-0.02 * x_sign} 0.01 0.00" rpy="0 0 0"/>
      			<mass value="0.297"/>
      			<inertia ixx="0.000283" ixy="0.000000" ixz="0.000000"
      				                    iyy="0.000161"  iyz="0.000000"
      				                                    izz="0.000346"/>
    		</inertial>
	 	</link>

	 	<link name="foot_${side}">
	 		<xacro:meshes file="foot_${side}" collision="True"/>
	 		<inertial>
	 			<origin xyz="${0.03 * x_sign} 0.00 -0.06" rpy="0 0 0"/>
      			<mass value="2.2"/>
						<inertia ixx="0.013004" ixy="-0.000212" ixz="0.000096"
      															iyy="0.005467" iyz="0.001058"
      				                                  		izz="0.015293"/>
    		</inertial>
	 	</link>

		<gazebo reference="foot_${side}">
			<kp>100000.0</kp>
			<kd>100.0</kd>
			<mu1>0.9</mu1>
			<mu2>0.09</mu2>
			<fdir1>1 1 0</fdir1>
			<maxVel>1.0</maxVel>
			<minDepth>0.0001</minDepth>
		</gazebo>


	 	<!-- hip z rotate (vertical)-->
	 	<joint name="hip_r_joint_${side}"
	 		   type="revolute">
	 		<parent link="${parent}"/>
	 		<child link="hip_fork_${side}"/>	 		
	 		<origin xyz="${0.088 * x_sign} 0.0276 0" rpy="0 0 0"/>
	 		<axis xyz="0 0 ${-x_sign}"/>
	 		<limit lower="${-20*d2r}" upper="${20*d2r}" effort="1000" velocity="10"/>
			 <dynamics damping="0.1" friction="0.0"/>
	 	</joint>

	 	<!-- hip y rotate (side)-->
	 	<joint name="hip_s_joint_${side}"
	 		   type="revolute">
	 		<parent link="hip_fork_${side}"/>
	 		<child link="hip_cross_${side}"/>	 		
	 		<origin xyz="0 0 0" rpy="0 0 0"/>
	 		<axis xyz="0 ${-x_sign} 0"/>	 		
	 		<xacro:lr_limit side="${side}" lower="${-25*d2r}" upper="${25*d2r}" effort="1000" velocity="10"/>
			 <dynamics damping="0.1" friction="0.0"/>
	 	</joint>

	 	<!-- hip x rotate (forward)-->
	 	<joint name="hip_f_joint_${side}"
	 		   type="revolute">
	 		<parent link="hip_cross_${side}"/>
	 		<child link="hip_${side}"/>
	 		<origin xyz="0 0 0" rpy="${ 0 * d2r} 0 0"/>
	 		<axis xyz="1 0 0"/>
	 		<limit lower="${-45*d2r}" upper="${70*d2r}" effort="1000" velocity="10"/>
			<dynamics damping="0.1" friction="0.0"/> 		
	 	</joint>

	 	<!-- knee -->
	 	<joint name="knee_joint_${side}"
	 		   type="revolute">
	 		<parent link="hip_${side}"/>
	 		<child link="shin_${side}"/>
	 		<origin xyz="0 0 -0.28" rpy="0 0 0"/>
	 		<axis xyz="1 0 0"/>
	 		<limit lower="${-140*d2r}" upper="0" effort="1000" velocity="10"/>
			 <dynamics damping="0.1" friction="0.0"/>
	 	</joint>

	 	<!-- ankle x (forward) -->
	 	<joint name="ankle_f_joint_${side}"
	 		   type="revolute">
	 		<parent link="shin_${side}"/>
	 		<child link="ankle_${side}"/>
	 		<origin xyz="0 0 -0.28" rpy="0 0 0"/>
	 		<axis xyz="1 0 0"/>
	 		<limit lower="${-70*d2r}" upper="${70*d2r}" effort="1000" velocity="10"/>
			 <dynamics damping="0.1" friction="0.0"/>
	 	</joint>

	 	<!-- ankle y (side) -->
	 	<joint name="ankle_s_joint_${side}"
	 		   type="revolute">
	 		<parent link="ankle_${side}"/>
	 		<child link="foot_${side}"/>
	 		<origin xyz="0 0 0" rpy="0 0 0"/>
	 		<axis xyz="0 ${-x_sign} 0"/>	 		
	 		<xacro:lr_limit side="${side}" lower="${-25*d2r}" upper="${25*d2r}" effort="1000" velocity="10"/>
			<dynamics damping="0.1" friction="0.0"/>
	 	</joint>

	 	<xacro:transmission_block joint_name="hip_r_joint_${side}"/>
	 	<xacro:transmission_block joint_name="hip_s_joint_${side}"/>
	 	<xacro:transmission_block joint_name="hip_f_joint_${side}"/>
	 	<xacro:transmission_block joint_name="knee_joint_${side}"/>
	 	<xacro:transmission_block joint_name="ankle_f_joint_${side}"/>
	 	<xacro:transmission_block joint_name="ankle_s_joint_${side}"/>

 	</xacro:macro>

</robot>
